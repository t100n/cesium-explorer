function log(){function t(){try{throw Error("")}catch(t){return t}}var s="";void 0==window.loglevel&&(window.loglevel=0);var n=t(),o=n.stack?n.stack.split("\n")[4]:"",e=o.indexOf("at "),i=o.slice(e+2,o.length);if("error"==arguments[0]||"warning"==arguments[0]&&window.loglevel>0||"info"==arguments[0]&&window.loglevel>1){for(var r=0;r<arguments.length;r++)s+="object"==typeof arguments[r]?JSON.stringify(arguments[r]):arguments[r],r<arguments.length-1&&(s+=", ");"undefined"!=typeof console&&console.log(i,s)}}function AudioMonkey(){this["class"]="AudioMonkey",this.FINISHED_STATE=3,this.PLAYING_STATE=2,this.SCHEDULED_STATE=1,this.UNSCHEDULED_STATE=0,this.FADE_TIME=1,this.FREQ_MUL=7e3,this.QUAL_MUL=30,this.context=!1,this.manifest={},this.format=""!==(new Audio).canPlayType("audio/ogg")?"ogg":"mp3",this.sounds={},this.init=function(){try{this.stopAll(),this.context||(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext);for(var t in this.manifest)this.load(t,this.manifest[t])}catch(s){}},this.syncStream=function(t){try{var s=new Uint8Array(t.response);s.indexOf=Array.prototype.indexOf;for(var n=t.sync,o=s;;){if(t.retry++,n=o.indexOf(255,n),-1==n||o[n+1]&!0)break;n++}if(-1!=n){var e=t.response.slice(n);return delete t.response,t.response=null,t.response=e,t.sync=n,!0}}catch(i){log("error",i)}return!1},this.cloneAudioBuffer=function(t){try{for(var s=[],n=0,o=t.numberOfChannels,e=0;o>e;e++)try{s[e]=new Float32Array(t.getChannelData(e)),n++}catch(i){}for(var r=this.context.createBuffer(t.numberOfChannels,t.length,t.sampleRate),e=0;o>e;e++)try{r.getChannelData(e).set(s[e])}catch(i){}return r}catch(i){return log("error",i),!1}},this.decode=function(t,s){var n=this;n.context.decodeAudioData(s.response,function(s){"undefined"!=typeof n.sounds[t]&&(n.sounds[t].buffer=s,n.sounds[t].loaded=!0)},function(){})},this.stopAll=function(){for(var t in this.sounds)this.stop(t)},this.pauseAll=function(){for(var t in this.sounds)try{if(this.sounds[t].pausedAt=Date.now(),"undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.playbackState(t)==this.FINISHED_STATE)continue;this.sounds[t].sound.stop||(this.sounds[t].sound.stop=this.sounds[t].sound.noteOff);try{this.sounds[t].sound.stop(0)}catch(s){}}catch(s){log("error",s)}},this.resumeAll=function(){for(var t in this.sounds)this.play(t)},this.add=function(t,s){this.manifest[t]=s},this.remove=function(t){try{delete this.manifest[t],this.stop(t),"undefined"!=typeof this.sounds[t]&&(this.sounds[t].sound=null,this.sounds[t].gain=null,this.sounds[t].buffer=null,delete this.sounds[t])}catch(s){log("error",s)}},this.load=function(t,s){try{var n,o=this,e=new XMLHttpRequest;n="string"==typeof s?s:"ogg"==this.format?s.ogg:s.mp3,e.open("GET",n,!0),e.responseType="arraybuffer",this.sounds[t]={sound:!1,buffer:!1,gain:!1,filter:!1,loaded:!1,fadding:!1,startTime:0,startedAt:!1,pausedAt:!1},e.onload=function(){e.buf=e.response,e.sync=0,e.retry=0,o.decode(t,e)},e.send()}catch(i){log("error",i)}},this.playbackState=function(t){if(this.sounds[t]&&this.sounds[t].sound){if(this.sounds[t].sound.playbackState)return this.sounds[t].sound.playbackState;if("running"==this.sounds[t].sound.context.state)return this.PLAYING_STATE}return this.FINISHED_STATE},this.play=function(t,s,n,o,e,i,r,u){void 0==u&&(u=1),void 0==window.globalVolume&&(window.globalVolume=1);var a,d,h;try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||this.sounds[t].fadding)return;if(0==window.globalVolume&&this.sounds[t].sound)return this.stop(t);if(0==window.globalVolume)return;if(this.sounds[t].reversed&&o>0)return this.stop(t);if(this.sounds[t].sound&&this.playbackState(t)==this.PLAYING_STATE&&!this.sounds[t].reversed){if(e)return;this.stop(t)}}catch(l){log("error",l)}try{a=this.context.createBufferSource(),this.sounds[t].sound=a,this.sounds[t].reversed=!1,d=this.sounds[t].buffer,0>o&&(d=this.cloneAudioBuffer(this.sounds[t].buffer),d.numberOfChannels>0&&Array.prototype.reverse.call(d.getChannelData(0)),d.numberOfChannels>1&&Array.prototype.reverse.call(d.getChannelData(1))),a.buffer=d,o&&(a.playbackRate.value=Math.abs(parseFloat(o))),e&&(a.loop=!0,a.loopStart=0,a.loopEnd=this.sounds[t].buffer.duration),e&&i&&(a.loopStart=i),e&&r&&(a.loopEnd=r)}catch(l){log("error",l)}try{a.start||(a.start=a.noteOn),o>0?a.start(this.context.currentTime,s*this.sounds[t].buffer.duration*o+n):a.start(this.context.currentTime,s*this.sounds[t].buffer.duration+n)}catch(l){log("error",l)}this.sounds[t].sound=a;try{h=this.context.createGain(),this.sounds[t].gain=h,a.connect(h),h.connect(this.context.destination)}catch(l){log("error",l)}try{"undefined"!=typeof this.sounds[t].gain.gain&&(this.sounds[t].gain.gain.value=u*window.globalVolume)}catch(l){log("error",l)}try{this.sounds[t].startTime=this.context.currentTime,this.sounds[t].startedAt=Date.now()}catch(l){log("error",l)}try{"undefined"==typeof this.sounds[t].sound.playbackState&&(this.sounds[t].sound.playbackState=this.PLAYING_STATE);var f=this;this.sounds[t].sound.onended=function(){this.playbackState=f.FINISHED_STATE}}catch(l){log("error",l)}},this.reverse=function(t){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.sounds[t].reversed)return;this.sounds[t].reversed=!0;var s=this.cloneAudioBuffer(this.sounds[t].buffer);s.numberOfChannels>0&&Array.prototype.reverse.call(s.getChannelData(0)),s.numberOfChannels>1&&Array.prototype.reverse.call(s.getChannelData(1)),this.sounds[t].sound.loop=!1,this.sounds[t].sound.buffer=s,this.sounds[t].sound.start(this.context.currentTime,this.sounds[t].sound.loopStart)}catch(n){log("error",n)}},this.rate=function(t,s){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.sounds[t].reversed)return;s&&(this.sounds[t].sound.playbackRate.value=Math.abs(parseFloat(s)))}catch(n){log("error",n)}},this.volume=function(t,s){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.sounds[t].reversed)return;"undefined"!=typeof this.sounds[t].gain.gain&&(this.sounds[t].gain.gain.cancelScheduledValues(this.context.currentTime),this.sounds[t].gain.gain.setValueAtTime(s*window.globalVolume,this.context.currentTime))}catch(n){log("error",n)}},this.changeFrequency=function(t,s){try{var n=40,o=this.context.sampleRate/2,e=Math.log(o/n)/Math.LN2,i=Math.pow(2,e*(s-1));this.sounds[t].filter.frequency.value=o*i}catch(r){log("error",r)}},this.changeQuality=function(t,s){try{this.sounds[t].filter.Q.value=s*this.QUAL_MUL}catch(n){log("error",n)}},this.stop=function(t){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.playbackState(t)==this.FINISHED_STATE)return;this.sounds[t].sound.stop||(this.sounds[t].sound.stop=this.sounds[t].sound.noteOff);try{this.sounds[t].sound.stop(0),this.sounds[t].sound=!1}catch(s){log("error",s)}}catch(s){log("error",s)}},this.fadeOut=function(t){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.playbackState(t)==this.FINISHED_STATE)return;var s=this,n=50,o=function(t,e){return 0>e?s.sounds[t].sound.stop():("undefined"!=typeof s.sounds[t].gain.gain&&(s.sounds[t].gain.gain.value=e),void setTimeout(function(){o(t,e-.05)},n))};"undefined"!=typeof s.sounds[t].gain.gain&&o(t,s.sounds[t].gain.gain.value)}catch(e){log("error",e)}},this.fadeIn=function(t){try{if("undefined"==typeof this.sounds[t]||!this.sounds[t].loaded||!this.sounds[t].sound||this.playbackState(t)==this.FINISHED_STATE)return;this.sounds[t].fadding=!0;var s=this,n=50,o=function(t,e){return e>1?s.sounds[t].fadding=!1:("undefined"!=typeof s.sounds[t].gain.gain&&(s.sounds[t].gain.gain.value=e),void setTimeout(function(){o(t,e+.05)},n))};o(t,0)}catch(e){log("error",e)}},this.crossfade=function(t,s){try{var n=this.sounds[t].sound,o=this.sounds[t].gain,e=this.sounds[t].buffer.duration,i=this.context.currentTime;o.gain.linearRampToValueAtTime(0,i),o.gain.linearRampToValueAtTime(1,i+this.FADE_TIME),n.start(0),o.gain.linearRampToValueAtTime(1,i+e-ctx.FADE_TIME),o.gain.linearRampToValueAtTime(0,i+e);var r=arguments.callee;this.timer=setTimeout(function(){r(s,t)},1e3*(e-this.FADE_TIME))}catch(u){log("error",u)}}}