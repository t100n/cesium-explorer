function log(){function s(){try{throw Error("")}catch(s){return s}}var t="";void 0==window.loglevel&&(window.loglevel=0);var e=s(),n=e.stack?e.stack.split("\n")[4]:"",o=n.indexOf("at "),i=n.slice(o+2,n.length);if("error"==arguments[0]||"warning"==arguments[0]&&window.loglevel>0||"info"==arguments[0]&&window.loglevel>1){for(var r=0;r<arguments.length;r++)t+="object"==typeof arguments[r]?JSON.stringify(arguments[r]):arguments[r],r<arguments.length-1&&(t+=", ");"undefined"!=typeof console&&console.log(i,t)}}function AudioMonkey(){if(this["class"]="AudioMonkey",this.FINISHED_STATE=3,this.PLAYING_STATE=2,this.SCHEDULED_STATE=1,this.UNSCHEDULED_STATE=0,this.FADE_TIME=1,this.FREQ_MUL=7e3,this.QUAL_MUL=30,this.context=!1,this.manifest={},this.format=""!==(new Audio).canPlayType("audio/ogg")?"ogg":"mp3",this.sounds={},!Platform.isChrome()&&createjs&&createjs.Sound){var s=this;this.handleLoad=function(t){s.sounds[t.id].loaded=!0},createjs.Sound.on("fileload",this.handleLoad)}this.init=function(){try{this.stopAll(),this.context||(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext);for(var s in this.manifest)this.load(s,this.manifest[s])}catch(t){}},this.syncStream=function(s){try{var t=new Uint8Array(s.response);t.indexOf=Array.prototype.indexOf;for(var e=s.sync,n=t;;){if(s.retry++,e=n.indexOf(255,e),-1==e||n[e+1]&!0)break;e++}if(-1!=e){var o=s.response.slice(e);return delete s.response,s.response=null,s.response=o,s.sync=e,!0}}catch(i){log("error",i)}return!1},this.cloneAudioBuffer=function(s){try{for(var t=[],e=0,n=s.numberOfChannels,o=0;n>o;o++)try{t[o]=new Float32Array(s.getChannelData(o)),e++}catch(i){}for(var r=this.context.createBuffer(s.numberOfChannels,s.length,s.sampleRate),o=0;n>o;o++)try{r.getChannelData(o).set(t[o])}catch(i){}return r}catch(i){return log("error",i),!1}},this.decode=function(s,t){var e=this;e.context.decodeAudioData(t.response,function(t){"undefined"!=typeof e.sounds[s]&&(e.sounds[s].buffer=t,e.sounds[s].loaded=!0)},function(){})},this.stopAll=function(){for(var s in this.sounds)this.stop(s)},this.pauseAll=function(){for(var s in this.sounds)try{if(this.sounds[s].pausedAt=Date.now(),"undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.playbackState(s)==this.FINISHED_STATE)continue;if(!Platform.isChrome()&&createjs&&createjs.Sound)this.sounds[s].sound.pause();else{this.sounds[s].sound.stop||(this.sounds[s].sound.stop=this.sounds[s].sound.noteOff);try{this.sounds[s].sound.stop(0)}catch(t){}}}catch(t){log("error",t)}},this.resumeAll=function(){for(var s in this.sounds)!Platform.isChrome()&&createjs&&createjs.Sound?this.sounds[s].sound.resume():this.play(s)},this.add=function(s,t){this.manifest[s]=t},this.remove=function(s){try{delete this.manifest[s],this.stop(s),"undefined"!=typeof this.sounds[s]&&(this.sounds[s].sound=null,this.sounds[s].gain=null,this.sounds[s].buffer=null,delete this.sounds[s],!Platform.isChrome()&&createjs&&createjs.Sound&&createjs.Sound.removeSound(s))}catch(t){log("error",t)}},this.load=function(s,t){try{var e,n=this,o=new XMLHttpRequest;e="string"==typeof t?t:"ogg"==this.format?t.ogg:t.mp3,this.sounds[s]={sound:!1,buffer:!1,gain:!1,filter:!1,loaded:!1,fadding:!1,startTime:0,startedAt:!1,pausedAt:!1},!Platform.isChrome()&&createjs&&createjs.Sound?(createjs.Sound.registerSound(e,s),this.sounds[s].loaded=!0):(o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(){o.buf=o.response,o.sync=0,o.retry=0,n.decode(s,o)},o.send())}catch(i){log("error",i)}},this.playbackState=function(s){if(this.sounds[s]&&this.sounds[s].sound)if(!Platform.isChrome()&&createjs&&createjs.Sound){if("playFinished"==this.sounds[s].sound.playState)return this.FINISHED_STATE;if("playSucceeded"==this.sounds[s].sound.playState)return this.PLAYING_STATE}else{if(this.sounds[s].sound.playbackState)return this.sounds[s].sound.playbackState;if("running"==this.sounds[s].sound.context.state)return this.PLAYING_STATE}return this.FINISHED_STATE},this.play=function(s,t,e,n,o,i,r,u){void 0==u&&(u=1),void 0==window.globalVolume&&(window.globalVolume=1);var a,d,h;try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||this.sounds[s].fadding)return;if(0==window.globalVolume&&this.sounds[s].sound)return this.stop(s);if(0==window.globalVolume)return;if(this.sounds[s].reversed&&n>0)return this.stop(s);if(this.sounds[s].sound&&this.playbackState(s)==this.PLAYING_STATE&&!this.sounds[s].reversed){if(o)return;this.stop(s)}}catch(l){log("error",l)}if(!Platform.isChrome()&&createjs&&createjs.Sound)this.sounds[s].sound=createjs.Sound.play(s,"none",0,t*n+e,0,u,0),n&&this.sounds[s].sound.sourceNode&&(this.sounds[s].sound.sourceNode.playbackRate.value=parseFloat(n)),o&&(this.sounds[s].loop=!0,this.sounds[s].loopStart=0),o&&i&&(this.sounds[s].loopStart=i),o&&r&&(this.sounds[s].loopEnd=r);else{try{a=this.context.createBufferSource(),this.sounds[s].sound=a,this.sounds[s].reversed=!1,d=this.sounds[s].buffer,0>n&&(d=this.cloneAudioBuffer(this.sounds[s].buffer),d.numberOfChannels>0&&Array.prototype.reverse.call(d.getChannelData(0)),d.numberOfChannels>1&&Array.prototype.reverse.call(d.getChannelData(1))),a.buffer=d,n&&(a.playbackRate.value=Math.abs(parseFloat(n))),o&&(a.loop=!0,a.loopStart=0,a.loopEnd=this.sounds[s].buffer.duration),o&&i&&(a.loopStart=i),o&&r&&(a.loopEnd=r)}catch(l){log("error",l)}try{a.start||(a.start=a.noteOn),n>0?a.start(this.context.currentTime,t*this.sounds[s].buffer.duration*n+e):a.start(this.context.currentTime,t*this.sounds[s].buffer.duration+e)}catch(l){log("error",l)}this.sounds[s].sound=a;try{h=this.context.createGain(),this.sounds[s].gain=h,a.connect(h),h.connect(this.context.destination)}catch(l){log("error",l)}try{"undefined"!=typeof this.sounds[s].gain.gain&&(this.sounds[s].gain.gain.value=u*window.globalVolume)}catch(l){log("error",l)}try{this.sounds[s].startTime=this.context.currentTime,this.sounds[s].startedAt=Date.now()}catch(l){log("error",l)}try{"undefined"==typeof this.sounds[s].sound.playbackState&&(this.sounds[s].sound.playbackState=this.PLAYING_STATE);var c=this;this.sounds[s].sound.onended=function(){this.playbackState=c.FINISHED_STATE}}catch(l){log("error",l)}}},this.reverse=function(s){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.sounds[s].reversed)return;this.sounds[s].reversed=!0;var t=this.cloneAudioBuffer(this.sounds[s].buffer);t.numberOfChannels>0&&Array.prototype.reverse.call(t.getChannelData(0)),t.numberOfChannels>1&&Array.prototype.reverse.call(t.getChannelData(1)),this.sounds[s].sound.loop=!1,this.sounds[s].sound.buffer=t,this.sounds[s].sound.start(this.context.currentTime,this.sounds[s].sound.loopStart)}catch(e){log("error",e)}},this.rate=function(s,t){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.sounds[s].reversed)return;t&&(!Platform.isChrome()&&createjs&&createjs.Sound?this.sounds[s].sound.sourceNode.playbackRate.value=parseFloat(t):this.sounds[s].sound.playbackRate.value=Math.abs(parseFloat(t)))}catch(e){log("error",e)}},this.volume=function(s,t){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.sounds[s].reversed)return;!Platform.isChrome()&&createjs&&createjs.Sound?this.sounds[s].sound.volume=t*window.globalVolume:"undefined"!=typeof this.sounds[s].gain.gain&&(this.sounds[s].gain.gain.cancelScheduledValues(this.context.currentTime),this.sounds[s].gain.gain.setValueAtTime(t*window.globalVolume,this.context.currentTime))}catch(e){log("error",e)}},this.changeFrequency=function(s,t){try{var e=40,n=this.context.sampleRate/2,o=Math.log(n/e)/Math.LN2,i=Math.pow(2,o*(t-1));this.sounds[s].filter.frequency.value=n*i}catch(r){log("error",r)}},this.changeQuality=function(s,t){try{this.sounds[s].filter.Q.value=t*this.QUAL_MUL}catch(e){log("error",e)}},this.stop=function(s){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.playbackState(s)==this.FINISHED_STATE)return;if(!Platform.isChrome()&&createjs&&createjs.Sound)this.sounds[s].sound.stop(),this.sounds[s].sound=!1;else{this.sounds[s].sound.stop||(this.sounds[s].sound.stop=this.sounds[s].sound.noteOff);try{this.sounds[s].sound.stop(0),this.sounds[s].sound=!1}catch(t){log("error",t)}}}catch(t){log("error",t)}},this.fadeOut=function(s){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.playbackState(s)==this.FINISHED_STATE)return;var t=this,e=50,n=function(s,o){return 0>o?t.sounds[s].sound.stop():("undefined"!=typeof t.sounds[s].gain.gain&&(t.sounds[s].gain.gain.value=o),void setTimeout(function(){n(s,o-.05)},e))};"undefined"!=typeof t.sounds[s].gain.gain&&n(s,t.sounds[s].gain.gain.value)}catch(o){log("error",o)}},this.fadeIn=function(s){try{if("undefined"==typeof this.sounds[s]||!this.sounds[s].loaded||!this.sounds[s].sound||this.playbackState(s)==this.FINISHED_STATE)return;this.sounds[s].fadding=!0;var t=this,e=50,n=function(s,o){return o>1?t.sounds[s].fadding=!1:("undefined"!=typeof t.sounds[s].gain.gain&&(t.sounds[s].gain.gain.value=o),void setTimeout(function(){n(s,o+.05)},e))};n(s,0)}catch(o){log("error",o)}},this.crossfade=function(s,t){try{var e=this.sounds[s].sound,n=this.sounds[s].gain,o=this.sounds[s].buffer.duration,i=this.context.currentTime;n.gain.linearRampToValueAtTime(0,i),n.gain.linearRampToValueAtTime(1,i+this.FADE_TIME),e.start(0),n.gain.linearRampToValueAtTime(1,i+o-ctx.FADE_TIME),n.gain.linearRampToValueAtTime(0,i+o);var r=arguments.callee;this.timer=setTimeout(function(){r(t,s)},1e3*(o-this.FADE_TIME))}catch(u){log("error",u)}}}